version: "3.7"
services:
        nginx:
                build: requirements/nginx
                image: nginx
                container_name: nginx
                ports:
                        - "443:443"
                volumes:
                        - dbdata:/volumes
                depends_on:
                        - wordpress
                env_file:
                        - .env
                networks:
                        - localhost
                restart: always
        wordpress:
                build: requirements/wordpress
                image: wordpress
                container_name: wordpress
                volumes:
                        - dbdata:/volumes
                depends_on:
                        - mariadb
                        - redis
                env_file:
                        - .env
                networks:
                        - localhost
                restart: always
        mariadb:
                build: requirements/mariadb
                image: mariadb
                container_name: mariadb
                volumes:
                        - mariadb:/var/lib/mysql
                env_file:
                        - .env
                networks:
                        - localhost
                restart: always
        redis:
                build: requirements/bonus/redis
                image: redis
                container_name: redis
                networks:
                        - localhost
                restart: always
        vsftpd:
                build: requirements/bonus/vsftpd
                image: vsftpd
                env_file:
                        - .env
                ports:
                  - "20:20"
                  - "21:21"
                container_name: vsftpd
                restart: always


volumes:
  dbdata:
    driver: local
    driver_opts:
      type: 'none'
      o: 'bind'
      device: '/home/nlocusso/data/wordpress/'
  mariadb:
    driver: local
    driver_opts:
      type: 'none'
      o: 'bind'
      device: '/home/nlocusso/data/mariadb/'

networks:
        localhost:
                driver: bridge
